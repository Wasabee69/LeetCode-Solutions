1948. Delete Duplicate Folders in System
Difficulty: Hard

Due to a bug, there are many duplicate folders in a file system. You are given a 2D array `paths`, where `paths[i]` is an array representing an absolute path to the i-th folder in the file system.

For example:
["one", "two", "three"] represents the path "/one/two/three".

Two folders (not necessarily on the same level) are identical if they contain the same non-empty set of identical subfolders and underlying subfolder structure. The folders do not need to be at the root level to be identical. If two or more folders are identical, then mark the folders as well as all their subfolders.

Example:
Folders "/a" and "/b" in the structure below are identical. They and all their subfolders should be marked:

/a
/a/x
/a/x/y
/a/z
/b
/b/x
/b/x/y
/b/z

However, if the structure also included "/b/w", then "/a" and "/b" would no longer be identical. But "/a/x" and "/b/x" would still be considered identical.

Once all identical folders and their subfolders are marked, the system deletes all of them in a single pass. Folders that become identical **after** deletion are not removed.

---

Return the 2D array `ans` containing the paths of the remaining folders. The paths may be returned in any order.

---

Examples:

Example 1:
Input: paths = [["a"],["c"],["d"],["a","b"],["c","b"],["d","a"]]
Output: [["d"],["d","a"]]
Explanation: Folders "/a" and "/c" are marked for deletion because they both contain a duplicate empty folder named "b".

Example 2:
Input: paths = [["a"],["c"],["a","b"],["c","b"],["a","b","x"],["a","b","x","y"],["w"],["w","y"]]
Output: [["c"],["c","b"],["a"],["a","b"]]
Explanation: Folders "/a/b/x" and "/w" are marked and deleted due to identical structures containing "y".

Example 3:
Input: paths = [["a","b"],["c","d"],["c"],["a"]]
Output: [["c"],["c","d"],["a"],["a","b"]]
Explanation: All folders are unique. Nothing is deleted.

---

Constraints:
- 1 <= paths.length <= 2 × 10⁴
- 1 <= paths[i].length <= 500
- 1 <= paths[i][j].length <= 10
- 1 <= sum(paths[i][j].length) <= 2 × 10⁵
- paths[i][j] consists of lowercase English letters.
- No two paths lead to the same folder.
- All parent folders of a non-root folder are guaranteed to appear in the input.
